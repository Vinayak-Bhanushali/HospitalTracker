<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <script src="./js/jquery.js"></script>
  <script>
    $(document).ready(function () {
      jsonString = '[{"address":"0xFA","name":"KEM Hospital","location":"Kurla"},{"address":"0xFB","name":"Rajawadi Hospital","location":"Ghatkopar"},{"address":"0xFC","name":"Kasturba Hospital","location":"Vidyvihar"}]';
      hospitalData = JSON.parse(jsonString)

      for (let i = 0; i < hospitalData.length; i++) {
        var $tr = $('<tr>').append(
          $('<th>').text(i),
          $('<td>').text(hospitalData[i].name),
          $('<td>').text(hospitalData[i].location),
          $('<td>').attr("id", hospitalData[i].address).append(
            $('<button>').text("Fetch").addClass("btn").addClass("btn-info").on("click", function e() {
              fetchHospitalData(hospitalData[i].address, hospitalData[i].address);
            })

          )
        ).appendTo('#hospitalTableBody');
      }
      // $.getJSON('hospital.json', function (hospitalData) {
      //     for (let i = 0; i < hospitalData.length; i++) {
      //       var $tr = $('<tr>').append(
      //         $('<th>').text(i),
      //         $('<td>').text(hospitalData[i].name),
      //         $('<td>').text(hospitalData[i].location),
      //         $('<td>').attr("id", hospitalData[i].address).append(
      //           $('<button>').text("Fetch").addClass("btn").addClass("btn-info").on("click", function e() {
      //             fetchHospitalData(hospitalData[i].address, hospitalData[i].address);
      //           })

      //         )
      //       ).appendTo('#hospitalTableBody');
      //     }
      // });
    });
  </script>
  <title>Hospital Managment</title>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">
      <img src="/docs/4.5/assets/brand/bootstrap-solid.svg" width="30" height="30" class="d-inline-block align-top"
        alt="" loading="lazy">
      Hospital Managment
    </a>
  </nav>
  <div class="container">
    <div class="table-responsive-sm">
      <table class="table table-hover" id="hospitalTable">
        <thead>
          <tr>
            <th scope="col" style="width: 10%">#</th>
            <th scope="col" style="width: 20%">Name</th>
            <th scope="col" style="width: 20%">Location</th>
            <th scope="col" style="width: 50%">Data</th>
          </tr>
        </thead>
        <tbody id="hospitalTableBody">
        </tbody>
      </table>
    </div>
  </div>
</body>
<script src="./BedTracker.js"></script>
<script src="./js/web3.min.js"></script>
<script src="./js/truffle-contract.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
<script>
  function fetchHospitalData(id, address) {
    $('#' + id).html("<div class='spinner-border' role='status'> <span class='sr-only'>Loading...</span></div>");

    // Fetch data and replace the following variables
    const totalBeds = 100;
    const usedBeds = 30;
    const availableBeds = totalBeds - usedBeds;
    $('#' + id).html("Total Beds: " + totalBeds + "\nUsed Beds: " + usedBeds + "\nAvailable Beds: " + availableBeds);
  }
</script>

</html>